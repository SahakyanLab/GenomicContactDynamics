Loading R-cbrg/current
  Loading requirement: gsl/2.6 hdf5/1.10.7 gdal/3.4.1 sqlite/3.37.2 proj/8.1.1
    geos/3.9.0 jags/4.3.0 java/17.0.1 cmake/3.17.2

R version 4.1.2 (2021-11-01) -- "Bird Hippie"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> ################################################################################
> # Density plot of log10 distances (in bp) from reference points
> ################################################################################
> # FLAGS * FLAGS * FLAGS * FLAGS * FLAGS * FLAGS * FLAGS * FLAGS * FLAGS * FLAGS
> ### DIRECTORY STRUCTURE ########################################################
> options(warnPartialMatchDollar=T) # Warning for left to right partial matching by $
> options(warn=1) # Expands warnings
> 
> whorunsit = "LiezelCluster" # "LiezelMac", "LiezelCluster", "LiezelLinuxDesk",
> # "AlexMac", "AlexCluster"
> 
> if( !is.null(whorunsit[1]) ){
+   # This can be expanded as needed ...
+   if(whorunsit == "LiezelMac"){
+     home.dir = "/Users/ltamon"
+     os = "Mac"
+   } else if(whorunsit == "LiezelCluster"){
+     home.dir = "/project/sahakyanlab/ltamon" #"/stopgap/sahakyanlab/" #"/t1-data/user"
+     os = "Linux"
+   } else {
+     stop("The supplied <whorunsit> option is not created in the script.", quote=F)
+   }
+ }
> lib = paste0(home.dir, "/DPhil/lib")
> data.dir = paste0(home.dir, "/Database")
> wk.dir = paste0(home.dir, "/SahakyanLab/GenomicContactDynamics/5_Location_2D")
> src.dir = paste0(wk.dir, "/out_distToRefPoints")
> out.dir = paste0(wk.dir, "/out_distToRefPoints_plot")
> ### OTHER SETTINGS #############################################################
> gcb = "min2Mb"
> chr.v = paste0("chr", c(1:22, "X"))
> chr.id = "chrALL" #"chr21and22"
> options(digits=15) # Digits beyond 15 could be unreliable
> # Should match ref.points order in src data (IJDISTTOREF.MX)
> ref.points.name = c("chr.start.bp", "chr.end.bp", "centromere.midP.bp") 
> ################################################################################
> # LIBRARIES & DEPENDENCIES * LIBRARIES & DEPENDENCIES * LIBRARIES & DEPENDENCIES 
> ################################################################################
> library(RColorBrewer)
> library(reshape2)
> library(ggplot2)
> source(paste0(lib, "/GG_bgr.R"))
> ################################################################################
> # MAIN CODE * MAIN CODE * MAIN CODE * MAIN CODE * MAIN CODE * MAIN CODE *
> #################################################################################
> ref.points.id <- paste(ref.points.name, collapse="_")
> df <- sapply(X=chr.v, simplify=F, FUN=function(chr){
+   load(paste0(src.dir, "/", gcb, "_", chr, "_ijdisttoref_", ref.points.id, ".RData"))
+   print(paste0(chr, ": Data obtained."))
+   return(IJDISTTOREF.MX)
+ })
[1] "chr1: Data obtained."
[1] "chr2: Data obtained."
[1] "chr3: Data obtained."
[1] "chr4: Data obtained."
[1] "chr5: Data obtained."
[1] "chr6: Data obtained."
[1] "chr7: Data obtained."
[1] "chr8: Data obtained."
[1] "chr9: Data obtained."
[1] "chr10: Data obtained."
[1] "chr11: Data obtained."
[1] "chr12: Data obtained."
[1] "chr13: Data obtained."
[1] "chr14: Data obtained."
[1] "chr15: Data obtained."
[1] "chr16: Data obtained."
[1] "chr17: Data obtained."
[1] "chr18: Data obtained."
[1] "chr19: Data obtained."
[1] "chr20: Data obtained."
[1] "chr21: Data obtained."
[1] "chr22: Data obtained."
[1] "chrX: Data obtained."
> df <- as.data.frame(do.call("rbind", df))
> 
> df$MINIMUMof.chr.start.bpVSchr.end.bp <- pmin(abs(df$chr.start.bp), abs(df$chr.end.bp))
> df$centromere.midP.bp <- abs(df$centromere.midP.bp)
> df$chr.start.bp <- df$chr.end.bp <- NULL
> 
> df <- reshape2::melt(df, id="Cp")
> df$Cp <- factor(as.numeric(as.character(df$Cp)), levels=1:21)
> 
> coul <- colorRampPalette( rev( brewer.pal(11, "Spectral") ) )( length(levels(df$Cp)))
> 
> # Density plot
> p <- ggplot(data=df, aes(x=log10(value), group=Cp)) +
+   geom_density( position="identity", aes(colour=Cp) ) + 
+   scale_colour_manual(values=coul) + 
+   labs(title=paste0(gcb, "_", chr.id, "_AbsoluteDistFromRef_lastbincontactsExcluded"), 
+        x="log10(distinbp)", colour="Cp") +
+   guides(colour=guide_legend(ncol=1)) +
+   bgr2 + 
+   facet_grid(. ~ variable)
>   
> 
> ggsave(filename=paste0(out.dir, "/", gcb, "_", chr.id, "_ijdisttoref_", ref.points.id, "_density.pdf"),
+        units="in", width=10, height=10, plot=p)
Warning: Removed 6390 rows containing non-finite values (stat_density).
> 
> 
> # rm(list=ls()); gc()
> 
CBB Profiling started Mon Oct  3 15:00:23 2022
SLURM_JOB_ID		4674226
REQ_CPU_CORES		1
REQ_MEMORY_GB		50.000000
Starting profiling...

                                                                                
                                                                                
                                    CPU (cores)                                 
    1 +---------------------------------------------------------------------+   
      |#####   +        +       +        +        +        +       +        |   
      |#                                                                    |   
      |#                                                                    |   
      |                                                                     |   
  0.8 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
  0.6 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
  0.4 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
  0.2 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
      |        +        +       +        +        +        +       +        |   
    0 +---------------------------------------------------------------------+   
      0       200      400     600      800      1000     1200    1400     1600 
                                Job profiling step                              
                                                                                

                                                                                
                                                                                
                                   Memory (GB)                                  
  60 +----------------------------------------------------------------------+   
     |        +        +        +        +       +        +        +        |   
     |                                                            # #       |   
     |                                                           ## #       |   
  50 |*****************************************************#*****##*#*    +-|   
     |                                                    ##  #######       |   
     |                                                    ##  #######       |   
     |                                                   ### #########      |   
  40 |-+                                                 ### #########    +-|   
     |                                           #   ####### ## ###  #      |   
     |                                           # # ####### ##             |   
  30 |-+                   ################### # # ###########            +-|   
     |             #########                 ############# #                |   
     | #############       #                 ######### ##  #                |   
     | #                                     #######   ##  #                |   
  20 |-#                                     ## ####   #   #              +-|   
     | #                                     ## ###    #   #                |   
     |##                                         ##        #                |   
     |##                                                                    |   
  10 |##                                                                  +-|   
     |#                                                                     |   
     |#                                                                     |   
     |#       +        +        +        +       +        +        +        |   
   0 +----------------------------------------------------------------------+   
     0       200      400      600      800     1000     1200     1400     1600 
                               Job profiling step                               
                                                                                

                                                                                
                                                                                
                                  Data read (GB)                                
  0.6 +---------------------------------------------------------------------+   
      |        +        +       +        +        +        +       +        |   
      |                                                                     |   
      |                                                                     |   
  0.5 |-+                                     ########################    +-|   
      |########################################                             |   
      |#                                                                    |   
      |#                                                                    |   
  0.4 |#+                                                                 +-|   
      |#                                                                    |   
      |#                                                                    |   
  0.3 |#+                                                                 +-|   
      |#                                                                    |   
      |#                                                                    |   
      |                                                                     |   
  0.2 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |                                                                     |   
  0.1 |-+                                                                 +-|   
      |                                                                     |   
      |                                                                     |   
      |        +        +       +        +        +        +       +        |   
    0 +---------------------------------------------------------------------+   
      0       200      400     600      800      1000     1200    1400     1600 
                                Job profiling step                              
                                                                                

                                                                                
                                                                                
                                   Data written (GB)                            
   0.0002 +-----------------------------------------------------------------+   
          |       +        +       +       +       +        +       +       |   
  0.00018 |-+                                                      ###    +-|   
          |                                                     ###         |   
          |                                                  ####           |   
  0.00016 |-+                                             ####            +-|   
          |                                            ####                 |   
  0.00014 |-+                                       ####                  +-|   
          |                                       ###                       |   
  0.00012 |-+                                  ####                       +-|   
          |                                 ####                            |   
   0.0001 |-+                            ####                             +-|   
          |                           ####                                  |   
          |                        ####                                     |   
    8e-05 |-+                   ####                                      +-|   
          |                  ####                                           |   
    6e-05 |-+             ####                                            +-|   
          |            ####                                                 |   
    4e-05 |-+        ###                                                  +-|   
          |       ###                                                       |   
          |    ####                                                         |   
    2e-05 |-####                                                          +-|   
          |##     +        +       +       +       +        +       +       |   
        0 +-----------------------------------------------------------------+   
          0      200      400     600     800     1000     1200    1400    1600 
                                  Job profiling step                            
                                                                                
